<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Check-in/out - Event</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <div class="scan-header">
    <h1>ğŸ“ Event Check-in/out</h1>
  </div>

  <div class="scan-container">
    <!-- Tabs -->
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('scan')">ğŸ“· QuÃ©t QR</button>
      <button class="tab-btn" onclick="switchTab('search')">ğŸ” TÃ¬m kiáº¿m</button>
    </div>

    <!-- Scan Tab -->
    <div id="scanTab" class="tab-content active">
      <div class="camera-container">
        <video id="video" autoplay playsinline></video>
        <div class="camera-overlay">
          <div class="scan-frame"></div>
          <p class="scan-hint">ÄÆ°a mÃ£ QR vÃ o khung hÃ¬nh</p>
        </div>
      </div>
      <div id="scanStatus" class="scan-status"></div>
      
      <!-- Test Button (for debugging) -->
      <button onclick="testQRCode()" class="btn-secondary" style="margin-top: 10px; width: 100%;">
        ğŸ§ª Test vá»›i mÃ£ QR thá»§ cÃ´ng
      </button>
    </div>

    <!-- Search Tab -->
    <div id="searchTab" class="tab-content">
      <div class="search-section">
        <input type="text" id="searchStudentInput" placeholder="ğŸ” Nháº­p tÃªn há»c sinh..." class="search-input">
        
        <div class="filter-chips">
          <button class="chip active" data-filter="checked-in">ÄÃ£ check-in</button>
          <button class="chip" data-filter="all">Táº¥t cáº£</button>
        </div>
        
        <div id="searchResults" class="search-results"></div>
      </div>
    </div>

    <!-- Student Detail (after scan/search) -->
    <div id="studentDetail" class="student-detail" style="display: none;">
      <div id="studentContent"></div>
    </div>

    <!-- Camera Capture -->
    <div id="cameraCapture" class="camera-capture" style="display: none;">
      <video id="captureVideo" autoplay playsinline></video>
      <canvas id="captureCanvas" style="display: none;"></canvas>
      <div class="capture-controls">
        <button onclick="takePicture()" class="btn-primary btn-large">ğŸ“· Chá»¥p áº£nh</button>
        <button onclick="closeCameraCapture()" class="btn-secondary">Há»§y</button>
      </div>
    </div>

    <!-- Photo Preview -->
    <div id="photoPreview" class="photo-preview" style="display: none;">
      <img id="previewImage" alt="Preview">
      <div class="preview-controls">
        <button onclick="confirmCheckIn()" class="btn-success btn-large">âœ“ XÃ¡c nháº­n CHECK-IN</button>
        <button onclick="retakePhoto()" class="btn-secondary">â†» Chá»¥p láº¡i</button>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <!-- KhÃ´ng cáº§n Storage -->
  <script src="../js/firebase-config.js"></script>
  
  <!-- QR Scanner Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsqr/1.4.0/jsQR.min.js"></script>
  
  <script src="../js/scan.js"></script>
</body>
</html>
